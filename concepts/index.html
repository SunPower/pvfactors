<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Main concepts &mdash; pvfactors 1.5.1+0.g3c619d3.dirty documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Installation" href="../installation/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pvfactors
            <img src="../_static/logo_small.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Main concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#d-geometries">2D geometries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#understanding-pv-array-2d-geometries">Understanding PV array 2D geometries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pv-array-parameters">PV array parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irradiance-models">Irradiance models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#available-models">Available models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#view-factor-calculator">View factor calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/index.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s New</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pvfactors</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Main concepts</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/SunPower/pvfactors/" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="main-concepts">
<span id="concepts"></span><h1>Main concepts<a class="headerlink" href="#main-concepts" title="Permalink to this headline"></a></h1>
<p>Understanding <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> is simple. The <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> package builds on top of 3 distinct blocks
that allow a clear workflow in the calculation of irradiance, while keeping the complexity
separated for the different aspects of modeling. The schematics below shows what these three blocks are.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/pvfactors_triangle.png"><img alt="../_images/pvfactors_triangle.png" src="../_images/pvfactors_triangle.png" style="width: 35%;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 1: The 3 building blocks of <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code></span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code>, everything starts with the 2D geometry of the PV array, and everything flows from there.</p>
<ul class="simple">
<li><p>The user will use the <a class="reference internal" href="#d-geometries"><span class="std std-ref">geometry API</span></a> to not only build the PV array geometry to be modeled, but also to get the results after the simulation.</p></li>
<li><p>A selected (or custom made) irradiance model can then be used to define the sky irradiance components that are incident on the surfaces. For instance in Fig. 2, the front surfaces of the PV rows are receiving direct sunlight, while their back surfaces aren’t receiving any. This is an example of what the irradiance model will define for all the surfaces.</p></li>
<li><p>A calculator can then be used to calculate a matrix of view factors between all the different surfaces.</p></li>
</ul>
<p>Finally, these 3 blocks will be assembled together inside the pvfactors engine (see <a class="reference internal" href="../developer/generated/pvfactors.engine.PVEngine.html#pvfactors.engine.PVEngine" title="pvfactors.engine.PVEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">PVEngine</span></code></a>) to solve the irradiance mathematical system described in the paper and in the <a class="reference internal" href="../theory/problem_formulation.html#problem-formulation"><span class="std std-ref">theory section</span></a>.</p>
<section id="d-geometries">
<span id="id1"></span><h2>2D geometries<a class="headerlink" href="#d-geometries" title="Permalink to this headline"></a></h2>
<p>The main interface for building the 2D geometry of a PV array is currently the <a class="reference internal" href="../developer/generated/pvfactors.geometry.pvarray.OrderedPVArray.html#pvfactors.geometry.pvarray.OrderedPVArray" title="pvfactors.geometry.pvarray.OrderedPVArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedPVArray</span></code></a> class. It can be used for modeling both fixed tilt and single-axis tracker systems on a flat ground. Here are some details on the concepts behind the <a class="reference internal" href="../developer/generated/pvfactors.geometry.pvarray.OrderedPVArray.html#pvfactors.geometry.pvarray.OrderedPVArray" title="pvfactors.geometry.pvarray.OrderedPVArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedPVArray</span></code></a> class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on how the geometry sub-package is organized, the user can refer to the <a class="reference internal" href="../developer/index.html#geometry-api"><span class="std std-ref">detailed geometry API</span></a>.</p>
</div>
<section id="understanding-pv-array-2d-geometries">
<h3>Understanding PV array 2D geometries<a class="headerlink" href="#understanding-pv-array-2d-geometries" title="Permalink to this headline"></a></h3>
<p>Let’s start with an example of a PV array 2D geometry plotted with <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code>.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/Example_pvarray.png"><img alt="../_images/Example_pvarray.png" src="../_images/Example_pvarray.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 2: Example of PV array 2D geometry in <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code></span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>As shown in the figure above, a <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> PV array is made out of a list of PV rows (the tilted blue lines), and a ground (the flat lines at y=0).</p>
<p>The PV rows:</p>
<ul class="simple">
<li><p>each PV row has 2 sides: a front and a back side</p></li>
<li><p>each side of a PV row is made out of segments. The segments are fixed sections whose location on the PV row side is always constant throughout the simulations, which allows the users to consistently track and calculate irradiance for given sections of a PV row side</p></li>
<li><p>each segment of each side of the PV rows is made out of collections of surfaces that are either shaded or illuminated, and these surfaces’ size and length change during the simulation because they depend on the PV row rotation angles and the sun’s position.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Fig. 2, the leftmost PV row’s front side has 3 segments, while its back side has only 1. And the center PV row’s back side has 2 segments, while its front side has only 1, etc.</p>
</div>
<p>The ground:</p>
<ul class="simple">
<li><p>it is made out of shaded surfaces (gray lines) and illuminated ones (yellow lines)</p></li>
<li><p>the size and length of the ground surfaces will change with the PV row rotation and the sun angles. Physically, the shaded surfaces represent the shadows of the PV rows that are cast on the ground.</p></li>
<li><p>the ground will also keep track of “cut points”, which are defined by the PV rows (1 per PV row), and which indicate the extent of the ground that a PV row front side and back side can see.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Fig. 2, we can see 3 ground shadows, and the figure also shows 2 cut points (but there is a 3rd one located outside of the figure range on the right side).</p>
</div>
</section>
<section id="pv-array-parameters">
<h3>PV array parameters<a class="headerlink" href="#pv-array-parameters" title="Permalink to this headline"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code>, a PV array has a number of fixed parameters that do not change with rotation and solar angles, and which can be passed as a dictionary with specific field names. Below is a sample of a PV array parameters dictionary, which was used to create the 2D geometry shown in Fig. 2.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pvarray_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_pvrows&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>                            <span class="c1"># number of pv rows</span>
    <span class="s1">&#39;pvrow_height&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>                      <span class="c1"># height of pv rows (measured at center / torque tube)</span>
    <span class="s1">&#39;pvrow_width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>                         <span class="c1"># width of pvrows</span>
    <span class="s1">&#39;axis_azimuth&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>                       <span class="c1"># azimuth angle of rotation axis</span>
    <span class="s1">&#39;gcr&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>                               <span class="c1"># ground coverage ratio</span>
    <span class="s1">&#39;cut&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;front&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;back&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}</span>  <span class="c1"># discretization scheme of the pv rows</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../tutorials/index.html#getting-started-ref"><span class="std std-ref">tutorial section</span></a> shows how such a dictionary can be used to create a PV array in <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> using the <a class="reference internal" href="../developer/generated/pvfactors.geometry.pvarray.OrderedPVArray.html#pvfactors.geometry.pvarray.OrderedPVArray" title="pvfactors.geometry.pvarray.OrderedPVArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedPVArray</span></code></a> class. Here is a description of what each parameter means:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_pvrows</span></code>: is the number of PV rows that the PV array will contain. In Fig. 2, we have 3 PV rows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvrow_height</span></code>: the PV row height (in meters) is the height of the PV row measured from the ground to the PV row center. In Fig. 2, the height of the PV rows is 2.5 m.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvrow_width</span></code>: the PV row width (in meters) is the cross-section width of the entire PV row. In Fig. 2, it’s the entire length of the blue lines, so 2 m in the example.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis_azimuth</span></code>: the PV array axis azimuth (in degrees) is the direction of the rotation axis of the PV rows (physically, it could be seen as the torque tube direction for single-axis trackers). The azimuth convention used in <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> is that 0 deg is North, 90 deg is East, etc. In the 2D plane of the PV array geometry (as shown in Fig. 2), the axis of rotation is always the vector normal to that 2D plane and with the direction going into the 2D plane. So <strong>positive rotation angles will lead to PV rows tilted to the left, and negative rotation angles will lead to PV rows tilted to the right</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcr</span></code>: it is the ground coverage ratio of the PV array. It is calculated as being equal to the ratio of the PV row width by the distance separating the PV row centers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cut</span></code>: this optional parameter is used to discretize the PV row sides into equal-length segments. For instance here, the front side of the leftmost PV row (always with index 0) will have 3 segments, and the back side of the center PV row (with index 1) will have 2 segments.</p></li>
</ul>
</section>
</section>
<section id="irradiance-models">
<h2>Irradiance models<a class="headerlink" href="#irradiance-models" title="Permalink to this headline"></a></h2>
<p>The irradiance models then assign irradiance sky values like direct, or circumsolar components to all the surfaces defined in the <a class="reference internal" href="../developer/generated/pvfactors.geometry.pvarray.OrderedPVArray.html#pvfactors.geometry.pvarray.OrderedPVArray" title="pvfactors.geometry.pvarray.OrderedPVArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedPVArray</span></code></a>.</p>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h3>
<p>As shown in the <a class="reference internal" href="../theory/problem_formulation.html#full-mode-theory"><span class="std std-ref">full mode theory</span></a> and
<a class="reference internal" href="../theory/problem_formulation.html#fast-mode-theory"><span class="std std-ref">fast mode theory</span></a> sections, we always need to calculate a sky term for the different surfaces of the PV array.</p>
<p>The sky term is the sum of all the irradiance components (for each surface) that are not directly related to the view factors or to the reflection process, but which still contribute to the incident irradiance on the surfaces. For instance, the direct component of the light incident on the front surface of a PV row is not directly dependent on the view factors, but we still need to account for it in the mathematical model, so this component will go into the sky term.</p>
<p>A lot of different assumptions can be made, which will lead to more or less accurate results. But
<code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> was designed to make the implementation of these assumptions modular: all of these assumptions can be implemented inside a single Python class which can be used by the other parts of the model. This was done to make it easy for users to create their own irradiance modeling assumptions (inside a new class), and to then plug it into the <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> <a class="reference internal" href="../developer/generated/pvfactors.engine.PVEngine.html#pvfactors.engine.PVEngine" title="pvfactors.engine.PVEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">PVEngine</span></code></a>.</p>
</section>
<section id="available-models">
<h3>Available models<a class="headerlink" href="#available-models" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pvfactors</span></code> currently provides two irradiance models that can be used interchangeably in the <a class="reference internal" href="../developer/generated/pvfactors.engine.PVEngine.html#pvfactors.engine.PVEngine" title="pvfactors.engine.PVEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">PVEngine</span></code></a> and with the <a class="reference internal" href="../developer/generated/pvfactors.geometry.pvarray.OrderedPVArray.html#pvfactors.geometry.pvarray.OrderedPVArray" title="pvfactors.geometry.pvarray.OrderedPVArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedPVArray</span></code></a>, and they are described in more details in the <a class="reference internal" href="../developer/index.html#irradiance-classes"><span class="std std-ref">irradiance developer API</span></a>.</p>
<ul class="simple">
<li><p>the isotropic model <a class="reference internal" href="../developer/generated/pvfactors.irradiance.models.IsotropicOrdered.html#pvfactors.irradiance.models.IsotropicOrdered" title="pvfactors.irradiance.models.IsotropicOrdered"><code class="xref py py-class docutils literal notranslate"><span class="pre">IsotropicOrdered</span></code></a> assumes that all of the diffuse light from the sky dome is isotropic. It is a very intuitive assumption, but it generally leads to less accurate results.</p></li>
<li><p>the (hybrid) perez model <a class="reference internal" href="../developer/generated/pvfactors.irradiance.models.HybridPerezOrdered.html#pvfactors.irradiance.models.HybridPerezOrdered" title="pvfactors.irradiance.models.HybridPerezOrdered"><code class="xref py py-class docutils literal notranslate"><span class="pre">HybridPerezOrdered</span></code></a> follows <a class="footnote-reference brackets" href="#perez-paper" id="id2">1</a> and assumes that the diffuse light can be broken down into circumsolar, isotropic, and horizon components (see Fig. 3 below). Validation work shows that this model is more accurate for calculating back-side irradiance with <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code>.</p></li>
</ul>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../_images/Irradiance_components.PNG"><img alt="../_images/Irradiance_components.PNG" src="../_images/Irradiance_components.PNG" style="width: 40%;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 3: Schematic showing direct and diffuse irradiance components on a PV system and according to the Perez diffuse light model <a class="footnote-reference brackets" href="#perez-paper" id="id3">1</a></span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="view-factor-calculator">
<h2>View factor calculator<a class="headerlink" href="#view-factor-calculator" title="Permalink to this headline"></a></h2>
<p>After creating a 2D geometry, the <a class="reference internal" href="../developer/generated/pvfactors.viewfactors.calculator.VFCalculator.html#pvfactors.viewfactors.calculator.VFCalculator" title="pvfactors.viewfactors.calculator.VFCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFCalculator</span></code></a> class can be used to calculate the view factors between all the surfaces of the array. A detailed description of what view factors are can be found in the <a class="reference internal" href="../theory/view_factors.html#view-factors-theory"><span class="std std-ref">theory section</span></a>.</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/differential_areas.png"><img alt="../_images/differential_areas.png" src="../_images/differential_areas.png" style="width: 15%;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 4: The view factor from a surface 1 to a surface 2 is the proportion of the space occupied by surface 2 in the hemisphere seen by surface 1.</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../tutorials/index.html#getting-started-ref"><span class="std std-ref">get started</span></a> using practical tutorials</p></li>
<li><p>learn more about the <a class="reference internal" href="../theory/index.html#theory"><span class="std std-ref">theory</span></a> behind <code class="docutils literal notranslate"><span class="pre">pvfactors</span></code></p></li>
<li><p>dive into the <a class="reference internal" href="../developer/index.html#developer-api"><span class="std std-ref">developer API</span></a></p></li>
</ul>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="perez-paper"><span class="brackets">1</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Perez, R., Seals, R., Ineichen, P., Stewart, R. and Menicucci, D., 1987. A new simplified version of the Perez diffuse irradiance model for tilted surfaces. Solar energy, 39(3), pp.221-231.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation/index.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorials/index.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, SunPower Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>